Search.setIndex({"alltitles": {"API Reference": [[0, null]], "Adding new grains": [[1, "adding-new-grains"]], "Contents": [[2, "contents"]], "Finetuning the U-Net model": [[1, "finetuning-the-u-net-model"]], "Getting started": [[1, null]], "Grain size analysis": [[1, "grain-size-analysis"]], "Hardware requirements": [[1, "hardware-requirements"]], "Installation": [[2, "installation"]], "Interactive editing of results": [[1, "interactive-editing-of-results"]], "Large image processing": [[1, "large-image-processing"]], "Loading the models": [[1, "loading-the-models"]], "Quality control of U-Net prediction": [[1, "quality-control-of-u-net-prediction"]], "Running the segmentation": [[1, "running-the-segmentation"]], "SAM segmentation": [[1, "sam-segmentation"]], "Saving results": [[1, "saving-results"]], "Training the U-Net model from scratch": [[1, "training-the-u-net-model-from-scratch"]], "segmenteverygrain": [[2, null]]}, "docnames": ["api_reference", "getting_started", "index"], "envversion": {"sphinx": 62, "sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2}, "filenames": ["api_reference.rst", "getting_started.rst", "index.rst"], "indexentries": {"calculate_iou() (in module segmenteverygrain)": [[0, "segmenteverygrain.calculate_iou", false]], "classify_points() (in module segmenteverygrain)": [[0, "segmenteverygrain.classify_points", false]], "click_for_scale() (in module segmenteverygrain)": [[0, "segmenteverygrain.click_for_scale", false]], "collect_polygon_from_mask() (in module segmenteverygrain)": [[0, "segmenteverygrain.collect_polygon_from_mask", false]], "compute_curvature() (in module segmenteverygrain)": [[0, "segmenteverygrain.compute_curvature", false]], "convert_to_large_image_coords() (in module segmenteverygrain)": [[0, "segmenteverygrain.convert_to_large_image_coords", false]], "create_and_train_model() (in module segmenteverygrain)": [[0, "segmenteverygrain.create_and_train_model", false]], "create_labeled_image() (in module segmenteverygrain)": [[0, "segmenteverygrain.create_labeled_image", false]], "create_train_val_test_data() (in module segmenteverygrain)": [[0, "segmenteverygrain.create_train_val_test_data", false]], "extract_patch() (in module segmenteverygrain)": [[0, "segmenteverygrain.extract_patch", false]], "find_connected_components() (in module segmenteverygrain)": [[0, "segmenteverygrain.find_connected_components", false]], "find_grain_size_classes() (in module segmenteverygrain)": [[0, "segmenteverygrain.find_grain_size_classes", false]], "find_overlapping_polygons() (in module segmenteverygrain)": [[0, "segmenteverygrain.find_overlapping_polygons", false]], "get_area_weighted_distribution() (in module segmenteverygrain)": [[0, "segmenteverygrain.get_area_weighted_distribution", false]], "get_grains_from_patches() (in module segmenteverygrain)": [[0, "segmenteverygrain.get_grains_from_patches", false]], "label_grains() (in module segmenteverygrain)": [[0, "segmenteverygrain.label_grains", false]], "load_and_preprocess() (in module segmenteverygrain)": [[0, "segmenteverygrain.load_and_preprocess", false]], "merge_overlapping_polygons() (in module segmenteverygrain)": [[0, "segmenteverygrain.merge_overlapping_polygons", false]], "onclick() (in module segmenteverygrain)": [[0, "segmenteverygrain.onclick", false]], "onclick2() (in module segmenteverygrain)": [[0, "segmenteverygrain.onclick2", false]], "onclick_large_image() (in module segmenteverygrain)": [[0, "segmenteverygrain.onclick_large_image", false]], "one_point_prompt() (in module segmenteverygrain)": [[0, "segmenteverygrain.one_point_prompt", false]], "onpress() (in module segmenteverygrain)": [[0, "segmenteverygrain.onpress", false]], "onpress2() (in module segmenteverygrain)": [[0, "segmenteverygrain.onpress2", false]], "patchify_training_data() (in module segmenteverygrain)": [[0, "segmenteverygrain.patchify_training_data", false]], "pick_most_similar_polygon() (in module segmenteverygrain)": [[0, "segmenteverygrain.pick_most_similar_polygon", false]], "plot_grain_axes_and_centroids() (in module segmenteverygrain)": [[0, "segmenteverygrain.plot_grain_axes_and_centroids", false]], "plot_histogram_of_axis_lengths() (in module segmenteverygrain)": [[0, "segmenteverygrain.plot_histogram_of_axis_lengths", false]], "plot_image_w_colorful_grains() (in module segmenteverygrain)": [[0, "segmenteverygrain.plot_image_w_colorful_grains", false]], "plot_images_and_labels() (in module segmenteverygrain)": [[0, "segmenteverygrain.plot_images_and_labels", false]], "predict_image() (in module segmenteverygrain)": [[0, "segmenteverygrain.predict_image", false]], "predict_image_tile() (in module segmenteverygrain)": [[0, "segmenteverygrain.predict_image_tile", false]], "predict_large_image() (in module segmenteverygrain)": [[0, "segmenteverygrain.predict_large_image", false]], "rasterize_grains() (in module segmenteverygrain)": [[0, "segmenteverygrain.rasterize_grains", false]], "read_polygons() (in module segmenteverygrain)": [[0, "segmenteverygrain.read_polygons", false]], "sam_segmentation() (in module segmenteverygrain)": [[0, "segmenteverygrain.sam_segmentation", false]], "save_polygons() (in module segmenteverygrain)": [[0, "segmenteverygrain.save_polygons", false]], "two_point_prompt() (in module segmenteverygrain)": [[0, "segmenteverygrain.two_point_prompt", false]], "unet() (in module segmenteverygrain)": [[0, "segmenteverygrain.Unet", false]], "weighted_crossentropy() (in module segmenteverygrain)": [[0, "segmenteverygrain.weighted_crossentropy", false]]}, "objects": {"segmenteverygrain": [[0, 0, 1, "", "Unet"], [0, 0, 1, "", "calculate_iou"], [0, 0, 1, "", "classify_points"], [0, 0, 1, "", "click_for_scale"], [0, 0, 1, "", "collect_polygon_from_mask"], [0, 0, 1, "", "compute_curvature"], [0, 0, 1, "", "convert_to_large_image_coords"], [0, 0, 1, "", "create_and_train_model"], [0, 0, 1, "", "create_labeled_image"], [0, 0, 1, "", "create_train_val_test_data"], [0, 0, 1, "", "extract_patch"], [0, 0, 1, "", "find_connected_components"], [0, 0, 1, "", "find_grain_size_classes"], [0, 0, 1, "", "find_overlapping_polygons"], [0, 0, 1, "", "get_area_weighted_distribution"], [0, 0, 1, "", "get_grains_from_patches"], [0, 0, 1, "", "label_grains"], [0, 0, 1, "", "load_and_preprocess"], [0, 0, 1, "", "merge_overlapping_polygons"], [0, 0, 1, "", "onclick"], [0, 0, 1, "", "onclick2"], [0, 0, 1, "", "onclick_large_image"], [0, 0, 1, "", "one_point_prompt"], [0, 0, 1, "", "onpress"], [0, 0, 1, "", "onpress2"], [0, 0, 1, "", "patchify_training_data"], [0, 0, 1, "", "pick_most_similar_polygon"], [0, 0, 1, "", "plot_grain_axes_and_centroids"], [0, 0, 1, "", "plot_histogram_of_axis_lengths"], [0, 0, 1, "", "plot_image_w_colorful_grains"], [0, 0, 1, "", "plot_images_and_labels"], [0, 0, 1, "", "predict_image"], [0, 0, 1, "", "predict_image_tile"], [0, 0, 1, "", "predict_large_image"], [0, 0, 1, "", "rasterize_grains"], [0, 0, 1, "", "read_polygons"], [0, 0, 1, "", "sam_segmentation"], [0, 0, 1, "", "save_polygons"], [0, 0, 1, "", "two_point_prompt"], [0, 0, 1, "", "weighted_crossentropy"]]}, "objnames": {"0": ["py", "function", "Python function"]}, "objtypes": {"0": "py:function"}, "terms": {"0": [0, 1], "1": [0, 1], "10": [0, 1], "100": [0, 1], "1000": 0, "10058049": 1, "128": 0, "15": 1, "16": 1, "1d": 0, "2": 1, "20": [0, 1], "200": 1, "2000": [0, 1], "2000x3000": 1, "256": 1, "256x256": [0, 1], "2d": 0, "3": [0, 1], "300": 0, "32": 1, "3d": 0, "4": [0, 1], "400": 1, "44": 1, "48": 1, "533": 1, "66": 1, "7": 0, "8": 1, "922": 1, "937": 1, "A": [0, 1], "For": [1, 2], "If": [0, 1], "In": 1, "It": 0, "One": 0, "Or": 2, "That": 1, "The": [0, 1, 2], "Then": 1, "These": [1, 2], "To": [1, 2], "_imag": 1, "_mask": 1, "_subplot": 0, "abov": 1, "access": 1, "accordingli": 0, "accuraci": [0, 1], "ad": [0, 2], "adam": 1, "add": [0, 1], "adjust": 0, "after": 1, "again": 1, "aim": 2, "all": [0, 1], "all_coord": [0, 1], "all_grain": [0, 1], "allow": 0, "also": [1, 2], "an": [0, 1], "analysi": 2, "anyth": [0, 1, 2], "api": 2, "append": 0, "appl": 2, "appli": 0, "approach": [0, 2], "ar": [0, 1, 2], "area": [0, 1], "around": 0, "arrai": [0, 1], "assign": 0, "assum": [0, 1], "astyp": 1, "augment": [0, 1], "automat": 2, "avail": 1, "averag": 0, "avoid": 1, "ax": [0, 1], "axessubplot": 0, "axi": 0, "backend_bas": 0, "background": [0, 1, 2], "bar": 1, "base": [0, 1, 2], "batch": 1, "befor": 1, "being": 0, "below": 1, "best": 1, "between": 0, "bin": 0, "binari": 0, "binsiz": 0, "bit": 1, "black": 1, "bool": 0, "boolean": 0, "both": 0, "bound": 0, "boundari": [0, 1], "button": [0, 1], "button_press_ev": 1, "c": 1, "calcul": [0, 1], "calculate_i": [0, 2], "can": [0, 1, 2], "canva": 1, "cd": 2, "center": 0, "centimet": 1, "centroid": [0, 1], "channel": [0, 1], "check": 0, "checkpoint": 1, "cid1": 1, "cid2": 1, "cid3": 1, "cid4": 1, "cid5": 1, "class": 0, "classif": 0, "classifi": 0, "classify_point": [0, 2], "clean": [1, 2], "click": [0, 1, 2], "click_for_scal": [0, 1, 2], "clone": 2, "cmap": 0, "code": [1, 2], "colab": 1, "collect": 0, "collect_polygon_from_mask": [0, 2], "color": 0, "color_bgr2rgb": 1, "colormap": 0, "com": [1, 2], "combin": 1, "come": 0, "common": 2, "comp": 0, "compil": 1, "complet": 1, "compon": 0, "comput": [0, 1], "compute_curvatur": [0, 2], "conda": 2, "connect": 0, "consid": 0, "consist": 1, "contain": [0, 1], "contour": 0, "control": 2, "convert": [0, 1], "convert_to_large_image_coord": [0, 2], "convolut": 2, "coord": [0, 1], "coordin": 0, "corner": 0, "correspond": [0, 1], "cpu": 1, "creat": [0, 1, 2], "create_and_train_model": [0, 1, 2], "create_labeled_imag": [0, 2], "create_train_val_test_data": [0, 1, 2], "cross": [0, 1], "csv": 1, "current": 0, "curv": 0, "curvatur": 0, "custom": 1, "custom_object": 1, "cv2": 1, "cvtcolor": 1, "d": [1, 2], "data": [0, 1], "datafram": [0, 1], "dataset": [0, 1, 2], "dbs_max_dist": [0, 1], "dbscan": 0, "deal": 2, "decreas": 0, "default": [0, 1], "defin": 1, "delet": [0, 1, 2], "deriv": 0, "describ": 1, "detect": [1, 2], "determin": [0, 2], "develop": 2, "dict": 0, "dictionari": 0, "directli": 1, "directori": [0, 1], "disconnect": 1, "displai": 0, "distanc": 0, "distribut": 0, "dl": 1, "do": [0, 1], "doe": [0, 2], "done": 0, "dot": 1, "download": 1, "e": 1, "each": [0, 1], "easiest": [1, 2], "edg": 0, "edit": 2, "either": 0, "end": [0, 1], "enough": 1, "entir": 0, "entropi": [0, 1], "environ": 2, "environment_maco": 2, "epoch": [0, 1], "establish": 1, "event": [0, 1], "everi": 2, "everyth": 2, "exampl": 1, "exist": [0, 1], "expect": 0, "extract": 0, "extract_patch": [0, 2], "fals": [0, 1], "fbaipublicfil": 1, "feature1": 0, "feature2": 0, "few": 1, "fig": [0, 1], "figsiz": 1, "figur": [0, 1], "file": [0, 1, 2], "filenam": [0, 1], "find": 0, "find_connected_compon": [0, 2], "find_grain_size_class": [0, 2], "find_overlapping_polygon": [0, 2], "fine": 1, "finetun": 2, "first": [0, 1, 2], "float": 0, "fname": [0, 1], "folder": 1, "follow": 1, "format": [0, 1], "found": 1, "fraction": 0, "from": [0, 2], "function": [0, 1, 2], "g": [0, 1], "gb": 1, "gener": [0, 1, 2], "geojson": 0, "geologi": 2, "geomorphologi": 2, "get": 2, "get_area_weighted_distribut": [0, 2], "get_grains_from_patch": [0, 1, 2], "git": 2, "github": [1, 2], "given": 0, "goal": 2, "goe": 1, "good": [0, 1, 2], "googl": 1, "gpu": [1, 2], "grain": [0, 2], "grain_data": [0, 1], "grain_ind": [0, 1], "grain_siz": 0, "grain_size_class": 0, "graph": 0, "greater": 0, "ha": 0, "handl": 0, "handler": [0, 1], "happi": 1, "hardwar": 2, "have": [0, 1], "here": 1, "hide": 1, "high": 2, "highlight": 0, "histogram": 0, "how": 1, "howev": 2, "http": [1, 2], "i": [0, 1, 2], "idea": 1, "im_alpha": 0, "im_til": 0, "im_tile_pr": 0, "imag": [0, 2], "image_dir": [0, 1], "image_path": 0, "image_pr": [0, 1], "img": 0, "import": 1, "improv": 2, "imshow": 1, "imwrit": 1, "includ": 2, "index": 0, "indic": 0, "infer": 1, "ing": 1, "initi": 1, "input": [0, 1], "input_dir": [0, 1], "insid": 1, "int": [0, 1], "intensity_imag": 1, "interact": 2, "interest": 0, "intersect": 0, "iou": 0, "ipynb": 1, "issu": 2, "iter": 0, "its": 0, "job": 2, "jpg": 1, "just": 1, "k": 1, "kei": [0, 1], "kera": [0, 1], "key_press_ev": 1, "keyev": 0, "label": [0, 1], "label_grain": [0, 1, 2], "labels_simpl": 0, "lambda": 1, "larg": [0, 2], "large_imag": 1, "larger": 1, "last": [0, 1], "latest": 1, "learn": 2, "least": 1, "left": [0, 1], "length": [0, 1], "like": [0, 1, 2], "limit": 0, "line": 0, "linewidth": 0, "link": 1, "list": [0, 1], "load": [0, 2], "load_and_preprocess": [0, 2], "load_img": 1, "load_model": 1, "locat": 0, "long": 1, "longer": 0, "loss": [0, 1], "low": 1, "lower": 0, "lower_bound": 0, "m": 1, "machin": 2, "major": 0, "major_axis_length": [0, 1], "make": [1, 2], "mamba": 2, "mani": 2, "mark": 0, "marker": 0, "markers": 0, "mask": [0, 1, 2], "mask_al": [0, 1], "mask_dir": [0, 1], "mask_path": 0, "match": 0, "matching_class": 0, "matplotlib": [0, 1], "max_bg_fract": 0, "max_image_pixel": 1, "max_intens": 1, "max_n_large_grain": 0, "maximum": 0, "mean_intens": 1, "measur": [0, 1], "memori": 1, "merg": [0, 1, 2], "merge_overlapping_polygon": [0, 2], "meta": 2, "method": 1, "metric": 1, "might": 1, "millimet": 0, "min_area": [0, 1], "min_intens": 1, "min_overlap": 0, "minimum": 0, "minor": 0, "minor_axis_length": [0, 1], "miss": 2, "mode": [1, 2], "model": [0, 2], "model_fil": [0, 1], "moder": 1, "more": [0, 1], "most": [0, 1, 2], "most_similar_polygon": 0, "mostli": 1, "mous": [0, 1], "mouseev": 0, "mpl_connect": 1, "mpl_disconnect": 1, "much": 1, "n_of_unit": 1, "name": [0, 1], "ndarrai": 0, "necessari": 1, "need": 1, "net": [0, 2], "network": 2, "networkx": 0, "neural": 2, "new": [0, 2], "new_grain": 0, "next": 1, "non": 2, "none": [0, 1], "note": 0, "notebook": 1, "now": 1, "np": [0, 1], "number": [0, 1], "numpi": [0, 1], "o": 1, "object": [0, 2], "older": 1, "onc": 1, "onclick": [0, 1, 2], "onclick2": [0, 1, 2], "onclick_large_imag": [0, 2], "one": [0, 1], "one_point_prompt": [0, 2], "onli": 1, "onpress": [0, 1, 2], "onpress2": [0, 1, 2], "optim": 1, "option": 0, "org": 1, "orient": 1, "other": [0, 1], "otherwis": 0, "ouput": 1, "outlin": [1, 2], "output": [0, 1], "outsid": 1, "over": 0, "overlai": 0, "overlap": [0, 1, 2], "overlapping_polygon": 0, "packag": [1, 2], "pair": 1, "panda": [0, 1], "paramet": [0, 1], "part": 1, "pass": 2, "patch": [0, 1, 2], "patch_dir": [0, 1], "patch_origin": 0, "patch_siz": [0, 1], "patchify_training_data": [0, 1, 2], "path": [0, 1], "pd": 1, "perform": [0, 1], "perimet": 1, "phi": 0, "photo": 2, "pick": 0, "pick_most_similar_polygon": [0, 2], "pil": 1, "pip": 2, "pixel": [0, 1], "place": 1, "plot": 0, "plot_grain_axes_and_centroid": [0, 2], "plot_histogram_of_axis_length": [0, 2], "plot_imag": [0, 1], "plot_image_w_colorful_grain": [0, 2], "plot_images_and_label": [0, 2], "plt": 1, "png": 1, "point": 0, "poly1": 0, "poly2": 0, "polygon": [0, 1], "posit": 0, "possibl": [0, 2], "power": 1, "predict": [0, 2], "predict_imag": [0, 1, 2], "predict_image_til": [0, 2], "predict_large_imag": [0, 1, 2], "predictor": [0, 1], "preliminari": 0, "preprocess": 0, "presenc": 0, "press": [0, 1], "print": 0, "process": [0, 2], "programmat": 1, "prompt": [0, 1, 2], "prop": 1, "properti": [0, 1], "provid": 0, "pth": 1, "purpos": 0, "pyplot": 1, "python": 2, "qc": [1, 2], "qualiti": 2, "randomli": 0, "rang": 0, "raster": 0, "rasterize_grain": [0, 1, 2], "read": 0, "read_polygon": [0, 2], "readi": 1, "real": 1, "reason": 2, "recent": 1, "recommend": 2, "record": 1, "reduc": 1, "refer": 2, "region": 0, "regionprops_t": 1, "rel": 0, "reli": 2, "remov": [0, 1], "remove_edge_grain": [0, 1], "remove_large_object": [0, 1], "repositori": [1, 2], "repres": [0, 1], "request": 1, "requir": 2, "restrict": 1, "result": [0, 2], "return": 0, "rgb": 1, "right": [0, 1], "run": [0, 2], "said": 1, "sam": [0, 2], "sam_model_registri": 1, "sam_segment": [0, 1, 2], "sam_vit_h_4b8939": 1, "sample1_imag": 1, "sample1_mask": 1, "sampredictor": [0, 1], "save": [0, 2], "save_polygon": [0, 2], "scale": [0, 1], "scale_bar_length_pixel": 1, "scatter": 1, "score": 0, "scratch": 2, "second": [0, 1], "section": 1, "sedimentari": 2, "see": 1, "seg": 1, "seg_model": 1, "seg_model_finetun": 1, "segmant": 0, "segment": [0, 2], "segment_anyth": 1, "segment_every_grain": 1, "segmenteverygrain": [0, 1], "select": 0, "select_onli": 0, "semant": 0, "set": [0, 2], "set_imag": 1, "shape": [0, 1, 2], "should": 1, "show": [0, 1], "side": 0, "signific": 0, "significantli": 1, "silicon": 2, "similar": 0, "singl": 0, "size": [0, 2], "skimag": 1, "slow": 2, "small": 1, "smaller": 1, "so": 2, "some": 2, "sourc": 2, "spatial": 0, "specifi": 0, "speed": 1, "split": [0, 1], "squar": 0, "start": 2, "step": 1, "store": 0, "str": 0, "stride": 0, "style": 2, "subdirectori": 0, "subfold": 1, "subplot": 0, "summar": 1, "suppos": 1, "sx": 0, "sy": 0, "take": [0, 1], "task": 2, "tend": 2, "tensor": 0, "tensorflow": 0, "termin": 1, "test": [0, 1], "test_dataset": [0, 1], "text": 1, "tf": 0, "than": [0, 1], "thei": 1, "them": [0, 2], "thi": [0, 1, 2], "third": 0, "three": 1, "threshold": 0, "through": 1, "tile": 0, "time": [0, 1], "to_csv": 1, "too": 1, "top": 0, "touch": 0, "train": [0, 2], "train_dataset": [0, 1], "train_unet_model": 1, "trigger": 0, "true": [0, 1], "tune": 1, "tupl": 0, "two": [0, 1], "two_point_prompt": [0, 2], "type": 0, "u": [0, 2], "unet": [0, 1, 2], "union": 0, "uniqu": 0, "unit": [0, 1], "units_per_pixel": 1, "unseg": 1, "unwant": 1, "up": [1, 2], "updat": [0, 1], "upper": 0, "upper_bound": 0, "url": 1, "urllib": 1, "urlretriev": 1, "us": [0, 1, 2], "user": [0, 2], "usual": 1, "util": 1, "val_dataset": [0, 1], "valid": [0, 1], "valu": [0, 1], "value1": 0, "value2": 0, "varieti": 1, "veri": [0, 1], "version": 1, "vertic": 0, "viridi": 0, "wa": [0, 1], "wai": [1, 2], "want": 1, "warn": 0, "we": 1, "weight": [0, 1], "weighted_crossentropi": [0, 1, 2], "well": [1, 2], "were": 2, "when": [0, 1, 2], "where": [0, 1], "whether": 0, "which": [0, 1, 2], "while": 1, "width": 0, "within": 0, "work": [1, 2], "workflow": 1, "x": [0, 1], "x1": 0, "x2": 0, "xlimit": 0, "xtick": 1, "y": 0, "y1": 0, "y2": 0, "y_pred": 0, "y_true": 0, "yml": 2, "you": [1, 2], "your": 1, "ytick": 1, "zenodo": 1, "zsylvest": 2}, "titles": ["API Reference", "Getting started", "segmenteverygrain"], "titleterms": {"ad": 1, "analysi": 1, "api": 0, "content": 2, "control": 1, "edit": 1, "finetun": 1, "from": 1, "get": 1, "grain": 1, "hardwar": 1, "imag": 1, "instal": 2, "interact": 1, "larg": 1, "load": 1, "model": 1, "net": 1, "new": 1, "predict": 1, "process": 1, "qualiti": 1, "refer": 0, "requir": 1, "result": 1, "run": 1, "sam": 1, "save": 1, "scratch": 1, "segment": 1, "segmenteverygrain": 2, "size": 1, "start": 1, "train": 1, "u": 1}})