Search.setIndex({"alltitles": {"API Reference": [[0, null]], "Classes": [[0, "classes"]], "Clustering grains": [[1, "clustering-grains"]], "Contents": [[2, "contents"]], "Core Segmentation Functions": [[0, "core-segmentation-functions"]], "Extracting individual grains": [[1, "extracting-individual-grains"]], "Feature extraction": [[1, "feature-extraction"]], "Finetuning the U-Net model": [[1, "finetuning-the-u-net-model"]], "Functions": [[0, "functions"]], "Getting started": [[1, null]], "Grain Extraction and Clustering (grain_utils module)": [[0, "grain-extraction-and-clustering-grain-utils-module"]], "Grain extraction and clustering": [[1, "grain-extraction-and-clustering"]], "Grain size analysis": [[1, "grain-size-analysis"]], "Hardware requirements": [[1, "hardware-requirements"]], "Installation": [[2, "installation"]], "Interactive Editing (interactions module)": [[0, "interactive-editing-interactions-module"]], "Interactive editing of results": [[1, "interactive-editing-of-results"]], "Interactive grain selection and labeling": [[1, "interactive-grain-selection-and-labeling"]], "Large image processing": [[1, "large-image-processing"]], "Legacy Interactive Functions": [[0, "legacy-interactive-functions"]], "Loading the models": [[1, "loading-the-models"]], "Model Prediction": [[0, "model-prediction"]], "Model Training": [[0, "model-training"]], "Polygon Operations": [[0, "polygon-operations"]], "Quality control of U-Net prediction": [[1, "quality-control-of-u-net-prediction"]], "Running the segmentation": [[1, "running-the-segmentation"]], "SAM segmentation": [[1, "sam-segmentation"]], "Saving results": [[1, "saving-results"]], "Scale bar and unit conversion": [[1, "scale-bar-and-unit-conversion"]], "Training the U-Net model from scratch": [[1, "training-the-u-net-model-from-scratch"]], "Utility Functions": [[0, "utility-functions"]], "Visualization": [[0, "visualization"]], "Visualizing classified grains": [[1, "visualizing-classified-grains"]], "segmenteverygrain": [[2, null]]}, "docnames": ["api_reference", "getting_started", "index"], "envversion": {"sphinx": 64, "sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2}, "filenames": ["api_reference.rst", "getting_started.rst", "index.rst"], "indexentries": {"activate() (segmenteverygrain.clustermontagelabeler method)": [[0, "segmenteverygrain.ClusterMontageLabeler.activate", false]], "activate() (segmenteverygrain.clustermontageselector method)": [[0, "id0", false], [0, "segmenteverygrain.ClusterMontageSelector.activate", false]], "activate() (segmenteverygrain.grainplot method)": [[0, "segmenteverygrain.GrainPlot.activate", false]], "calculate_iou() (in module segmenteverygrain)": [[0, "segmenteverygrain.calculate_iou", false]], "classify_points() (in module segmenteverygrain)": [[0, "segmenteverygrain.classify_points", false]], "clear_all() (segmenteverygrain.grainplot method)": [[0, "segmenteverygrain.GrainPlot.clear_all", false]], "clear_box() (segmenteverygrain.grainplot method)": [[0, "segmenteverygrain.GrainPlot.clear_box", false]], "clear_grains() (segmenteverygrain.grainplot method)": [[0, "segmenteverygrain.GrainPlot.clear_grains", false]], "clear_info() (segmenteverygrain.grainplot method)": [[0, "segmenteverygrain.GrainPlot.clear_info", false]], "clear_points() (segmenteverygrain.grainplot method)": [[0, "segmenteverygrain.GrainPlot.clear_points", false]], "click_for_scale() (in module segmenteverygrain)": [[0, "segmenteverygrain.click_for_scale", false]], "cluster_grains() (in module segmenteverygrain)": [[0, "segmenteverygrain.cluster_grains", false]], "clustermontagelabeler (class in segmenteverygrain)": [[0, "segmenteverygrain.ClusterMontageLabeler", false]], "clustermontageselector (class in segmenteverygrain)": [[0, "segmenteverygrain.ClusterMontageSelector", false]], "collect_polygon_from_mask() (in module segmenteverygrain)": [[0, "segmenteverygrain.collect_polygon_from_mask", false]], "compute_curvature() (in module segmenteverygrain)": [[0, "segmenteverygrain.compute_curvature", false]], "convert_to_large_image_coords() (in module segmenteverygrain)": [[0, "segmenteverygrain.convert_to_large_image_coords", false]], "convert_units() (segmenteverygrain.grain method)": [[0, "segmenteverygrain.Grain.convert_units", false]], "create_and_train_model() (in module segmenteverygrain)": [[0, "segmenteverygrain.create_and_train_model", false]], "create_clustered_grain_montage() (in module segmenteverygrain)": [[0, "segmenteverygrain.create_clustered_grain_montage", false]], "create_grain() (segmenteverygrain.grainplot method)": [[0, "segmenteverygrain.GrainPlot.create_grain", false]], "create_grain_panel() (in module segmenteverygrain)": [[0, "segmenteverygrain.create_grain_panel", false]], "create_grain_panel_cluster() (in module segmenteverygrain)": [[0, "segmenteverygrain.create_grain_panel_cluster", false]], "create_labeled_image() (in module segmenteverygrain)": [[0, "segmenteverygrain.create_labeled_image", false]], "create_train_val_test_data() (in module segmenteverygrain)": [[0, "segmenteverygrain.create_train_val_test_data", false]], "deactivate() (segmenteverygrain.clustermontagelabeler method)": [[0, "segmenteverygrain.ClusterMontageLabeler.deactivate", false]], "deactivate() (segmenteverygrain.clustermontageselector method)": [[0, "id1", false], [0, "segmenteverygrain.ClusterMontageSelector.deactivate", false]], "deactivate() (segmenteverygrain.grainplot method)": [[0, "segmenteverygrain.GrainPlot.deactivate", false]], "delete_grains() (segmenteverygrain.grainplot method)": [[0, "segmenteverygrain.GrainPlot.delete_grains", false]], "display_montage() (segmenteverygrain.clustermontageselector method)": [[0, "segmenteverygrain.ClusterMontageSelector.display_montage", false]], "draw_axes() (segmenteverygrain.grain method)": [[0, "segmenteverygrain.Grain.draw_axes", false]], "draw_axes() (segmenteverygrain.grainplot method)": [[0, "segmenteverygrain.GrainPlot.draw_axes", false]], "draw_patch() (segmenteverygrain.grain method)": [[0, "segmenteverygrain.Grain.draw_patch", false]], "draw_scale_line() (segmenteverygrain.grainplot method)": [[0, "segmenteverygrain.GrainPlot.draw_scale_line", false]], "erase() (segmenteverygrain.grain method)": [[0, "segmenteverygrain.Grain.erase", false]], "export_labels() (segmenteverygrain.clustermontagelabeler method)": [[0, "segmenteverygrain.ClusterMontageLabeler.export_labels", false]], "extract_all_grains() (in module segmenteverygrain)": [[0, "segmenteverygrain.extract_all_grains", false]], "extract_color_features() (in module segmenteverygrain)": [[0, "segmenteverygrain.extract_color_features", false]], "extract_grain_image() (in module segmenteverygrain)": [[0, "segmenteverygrain.extract_grain_image", false]], "extract_patch() (in module segmenteverygrain)": [[0, "segmenteverygrain.extract_patch", false]], "extract_vgg16_features() (in module segmenteverygrain)": [[0, "segmenteverygrain.extract_vgg16_features", false]], "find_connected_components() (in module segmenteverygrain)": [[0, "segmenteverygrain.find_connected_components", false]], "find_grain_size_classes() (in module segmenteverygrain)": [[0, "segmenteverygrain.find_grain_size_classes", false]], "find_overlapping_polygons() (in module segmenteverygrain)": [[0, "segmenteverygrain.find_overlapping_polygons", false]], "get_area_weighted_distribution() (in module segmenteverygrain)": [[0, "segmenteverygrain.get_area_weighted_distribution", false]], "get_filtered_grains() (segmenteverygrain.clustermontageselector method)": [[0, "id2", false], [0, "segmenteverygrain.ClusterMontageSelector.get_filtered_grains", false]], "get_filtered_images() (segmenteverygrain.clustermontageselector method)": [[0, "id3", false], [0, "segmenteverygrain.ClusterMontageSelector.get_filtered_images", false]], "get_filtered_indices() (segmenteverygrain.clustermontagelabeler method)": [[0, "segmenteverygrain.ClusterMontageLabeler.get_filtered_indices", false]], "get_filtered_indices() (segmenteverygrain.clustermontageselector method)": [[0, "id4", false], [0, "segmenteverygrain.ClusterMontageSelector.get_filtered_indices", false]], "get_filtered_labels() (segmenteverygrain.clustermontageselector method)": [[0, "id5", false], [0, "segmenteverygrain.ClusterMontageSelector.get_filtered_labels", false]], "get_grains() (segmenteverygrain.grainplot method)": [[0, "segmenteverygrain.GrainPlot.get_grains", false]], "get_grains_from_patches() (in module segmenteverygrain)": [[0, "segmenteverygrain.get_grains_from_patches", false]], "get_labeled_data() (segmenteverygrain.clustermontagelabeler method)": [[0, "segmenteverygrain.ClusterMontageLabeler.get_labeled_data", false]], "get_summary() (in module segmenteverygrain)": [[0, "segmenteverygrain.get_summary", false]], "get_unlabeled_indices() (segmenteverygrain.clustermontagelabeler method)": [[0, "segmenteverygrain.ClusterMontageLabeler.get_unlabeled_indices", false]], "grain (class in segmenteverygrain)": [[0, "segmenteverygrain.Grain", false]], "grainplot (class in segmenteverygrain)": [[0, "segmenteverygrain.GrainPlot", false]], "hide_grains() (segmenteverygrain.grainplot method)": [[0, "segmenteverygrain.GrainPlot.hide_grains", false]], "label_grains() (in module segmenteverygrain)": [[0, "segmenteverygrain.label_grains", false]], "load_and_preprocess() (in module segmenteverygrain)": [[0, "segmenteverygrain.load_and_preprocess", false]], "load_image() (in module segmenteverygrain)": [[0, "segmenteverygrain.load_image", false]], "make_square() (in module segmenteverygrain)": [[0, "segmenteverygrain.make_square", false]], "measure() (segmenteverygrain.grain method)": [[0, "segmenteverygrain.Grain.measure", false]], "merge_grains() (segmenteverygrain.grainplot method)": [[0, "segmenteverygrain.GrainPlot.merge_grains", false]], "merge_overlapping_polygons() (in module segmenteverygrain)": [[0, "segmenteverygrain.merge_overlapping_polygons", false]], "onclick() (in module segmenteverygrain)": [[0, "segmenteverygrain.onclick", false]], "onclick() (segmenteverygrain.clustermontagelabeler method)": [[0, "segmenteverygrain.ClusterMontageLabeler.onclick", false]], "onclick() (segmenteverygrain.clustermontageselector method)": [[0, "segmenteverygrain.ClusterMontageSelector.onclick", false]], "onclick() (segmenteverygrain.grainplot method)": [[0, "segmenteverygrain.GrainPlot.onclick", false]], "onclick2() (in module segmenteverygrain)": [[0, "segmenteverygrain.onclick2", false]], "onclick_large_image() (in module segmenteverygrain)": [[0, "segmenteverygrain.onclick_large_image", false]], "onclickup() (segmenteverygrain.grainplot method)": [[0, "segmenteverygrain.GrainPlot.onclickup", false]], "ondraw() (segmenteverygrain.clustermontagelabeler method)": [[0, "segmenteverygrain.ClusterMontageLabeler.ondraw", false]], "ondraw() (segmenteverygrain.grainplot method)": [[0, "segmenteverygrain.GrainPlot.ondraw", false]], "one_point_prompt() (in module segmenteverygrain)": [[0, "segmenteverygrain.one_point_prompt", false]], "onkey() (segmenteverygrain.clustermontagelabeler method)": [[0, "segmenteverygrain.ClusterMontageLabeler.onkey", false]], "onkey() (segmenteverygrain.clustermontageselector method)": [[0, "segmenteverygrain.ClusterMontageSelector.onkey", false]], "onkey() (segmenteverygrain.grainplot method)": [[0, "segmenteverygrain.GrainPlot.onkey", false]], "onkeyup() (segmenteverygrain.grainplot method)": [[0, "segmenteverygrain.GrainPlot.onkeyup", false]], "onmotion() (segmenteverygrain.grainplot method)": [[0, "segmenteverygrain.GrainPlot.onmotion", false]], "onpick() (segmenteverygrain.grainplot method)": [[0, "segmenteverygrain.GrainPlot.onpick", false]], "onpress() (in module segmenteverygrain)": [[0, "segmenteverygrain.onpress", false]], "onpress2() (in module segmenteverygrain)": [[0, "segmenteverygrain.onpress2", false]], "patchify_training_data() (in module segmenteverygrain)": [[0, "segmenteverygrain.patchify_training_data", false]], "pick_most_similar_polygon() (in module segmenteverygrain)": [[0, "segmenteverygrain.pick_most_similar_polygon", false]], "plot_classified_grains() (in module segmenteverygrain)": [[0, "segmenteverygrain.plot_classified_grains", false]], "plot_grain_axes_and_centroids() (in module segmenteverygrain)": [[0, "segmenteverygrain.plot_grain_axes_and_centroids", false]], "plot_histogram_of_axis_lengths() (in module segmenteverygrain)": [[0, "segmenteverygrain.plot_histogram_of_axis_lengths", false]], "plot_image_w_colorful_grains() (in module segmenteverygrain)": [[0, "segmenteverygrain.plot_image_w_colorful_grains", false]], "plot_images_and_labels() (in module segmenteverygrain)": [[0, "segmenteverygrain.plot_images_and_labels", false]], "polygon (segmenteverygrain.grain property)": [[0, "segmenteverygrain.Grain.polygon", false]], "polygons_to_grains() (in module segmenteverygrain)": [[0, "segmenteverygrain.polygons_to_grains", false]], "predict_image() (in module segmenteverygrain)": [[0, "segmenteverygrain.predict_image", false]], "predict_image_tile() (in module segmenteverygrain)": [[0, "segmenteverygrain.predict_image_tile", false]], "predict_large_image() (in module segmenteverygrain)": [[0, "segmenteverygrain.predict_large_image", false]], "rasterize_grains() (in module segmenteverygrain)": [[0, "segmenteverygrain.rasterize_grains", false]], "read_polygons() (in module segmenteverygrain)": [[0, "segmenteverygrain.read_polygons", false]], "sam_segmentation() (in module segmenteverygrain)": [[0, "segmenteverygrain.sam_segmentation", false]], "save_grains() (in module segmenteverygrain)": [[0, "segmenteverygrain.save_grains", false]], "save_histogram() (in module segmenteverygrain)": [[0, "segmenteverygrain.save_histogram", false]], "save_labeled_images() (segmenteverygrain.clustermontagelabeler method)": [[0, "segmenteverygrain.ClusterMontageLabeler.save_labeled_images", false]], "save_mask() (in module segmenteverygrain)": [[0, "segmenteverygrain.save_mask", false]], "save_polygons() (in module segmenteverygrain)": [[0, "segmenteverygrain.save_polygons", false]], "save_summary() (in module segmenteverygrain)": [[0, "segmenteverygrain.save_summary", false]], "savefig() (segmenteverygrain.grainplot method)": [[0, "segmenteverygrain.GrainPlot.savefig", false]], "select() (segmenteverygrain.grain method)": [[0, "segmenteverygrain.Grain.select", false]], "selected_clusters (segmenteverygrain.clustermontageselector attribute)": [[0, "segmenteverygrain.ClusterMontageSelector.selected_clusters", false]], "selected_grain_indices (segmenteverygrain.clustermontageselector attribute)": [[0, "segmenteverygrain.ClusterMontageSelector.selected_grain_indices", false]], "set_point() (segmenteverygrain.grainplot method)": [[0, "segmenteverygrain.GrainPlot.set_point", false]], "toggle_box() (segmenteverygrain.grainplot method)": [[0, "segmenteverygrain.GrainPlot.toggle_box", false]], "two_point_prompt() (in module segmenteverygrain)": [[0, "segmenteverygrain.two_point_prompt", false]], "undo_grain() (segmenteverygrain.grainplot method)": [[0, "segmenteverygrain.GrainPlot.undo_grain", false]], "unet() (in module segmenteverygrain)": [[0, "segmenteverygrain.Unet", false]], "update() (segmenteverygrain.clustermontagelabeler method)": [[0, "segmenteverygrain.ClusterMontageLabeler.update", false]], "update() (segmenteverygrain.grainplot method)": [[0, "segmenteverygrain.GrainPlot.update", false]], "update_info() (segmenteverygrain.grainplot method)": [[0, "segmenteverygrain.GrainPlot.update_info", false]], "weighted_crossentropy() (in module segmenteverygrain)": [[0, "segmenteverygrain.weighted_crossentropy", false]]}, "objects": {"segmenteverygrain": [[0, 0, 1, "", "ClusterMontageLabeler"], [0, 0, 1, "", "ClusterMontageSelector"], [0, 0, 1, "", "Grain"], [0, 0, 1, "", "GrainPlot"], [0, 4, 1, "", "Unet"], [0, 4, 1, "", "calculate_iou"], [0, 4, 1, "", "classify_points"], [0, 4, 1, "", "click_for_scale"], [0, 4, 1, "", "cluster_grains"], [0, 4, 1, "", "collect_polygon_from_mask"], [0, 4, 1, "", "compute_curvature"], [0, 4, 1, "", "convert_to_large_image_coords"], [0, 4, 1, "", "create_and_train_model"], [0, 4, 1, "", "create_clustered_grain_montage"], [0, 4, 1, "", "create_grain_panel"], [0, 4, 1, "", "create_grain_panel_cluster"], [0, 4, 1, "", "create_labeled_image"], [0, 4, 1, "", "create_train_val_test_data"], [0, 4, 1, "", "extract_all_grains"], [0, 4, 1, "", "extract_color_features"], [0, 4, 1, "", "extract_grain_image"], [0, 4, 1, "", "extract_patch"], [0, 4, 1, "", "extract_vgg16_features"], [0, 4, 1, "", "find_connected_components"], [0, 4, 1, "", "find_grain_size_classes"], [0, 4, 1, "", "find_overlapping_polygons"], [0, 4, 1, "", "get_area_weighted_distribution"], [0, 4, 1, "", "get_grains_from_patches"], [0, 4, 1, "", "get_summary"], [0, 4, 1, "", "label_grains"], [0, 4, 1, "", "load_and_preprocess"], [0, 4, 1, "", "load_image"], [0, 4, 1, "", "make_square"], [0, 4, 1, "", "merge_overlapping_polygons"], [0, 4, 1, "", "onclick"], [0, 4, 1, "", "onclick2"], [0, 4, 1, "", "onclick_large_image"], [0, 4, 1, "", "one_point_prompt"], [0, 4, 1, "", "onpress"], [0, 4, 1, "", "onpress2"], [0, 4, 1, "", "patchify_training_data"], [0, 4, 1, "", "pick_most_similar_polygon"], [0, 4, 1, "", "plot_classified_grains"], [0, 4, 1, "", "plot_grain_axes_and_centroids"], [0, 4, 1, "", "plot_histogram_of_axis_lengths"], [0, 4, 1, "", "plot_image_w_colorful_grains"], [0, 4, 1, "", "plot_images_and_labels"], [0, 4, 1, "", "polygons_to_grains"], [0, 4, 1, "", "predict_image"], [0, 4, 1, "", "predict_image_tile"], [0, 4, 1, "", "predict_large_image"], [0, 4, 1, "", "rasterize_grains"], [0, 4, 1, "", "read_polygons"], [0, 4, 1, "", "sam_segmentation"], [0, 4, 1, "", "save_grains"], [0, 4, 1, "", "save_histogram"], [0, 4, 1, "", "save_mask"], [0, 4, 1, "", "save_polygons"], [0, 4, 1, "", "save_summary"], [0, 4, 1, "", "two_point_prompt"], [0, 4, 1, "", "weighted_crossentropy"]], "segmenteverygrain.ClusterMontageLabeler": [[0, 1, 1, "", "activate"], [0, 1, 1, "", "deactivate"], [0, 1, 1, "", "export_labels"], [0, 1, 1, "", "get_filtered_indices"], [0, 1, 1, "", "get_labeled_data"], [0, 1, 1, "", "get_unlabeled_indices"], [0, 1, 1, "", "onclick"], [0, 1, 1, "", "ondraw"], [0, 1, 1, "", "onkey"], [0, 1, 1, "", "save_labeled_images"], [0, 1, 1, "", "update"]], "segmenteverygrain.ClusterMontageSelector": [[0, 1, 1, "id0", "activate"], [0, 1, 1, "id1", "deactivate"], [0, 1, 1, "", "display_montage"], [0, 1, 1, "id2", "get_filtered_grains"], [0, 1, 1, "id3", "get_filtered_images"], [0, 1, 1, "id4", "get_filtered_indices"], [0, 1, 1, "id5", "get_filtered_labels"], [0, 1, 1, "", "onclick"], [0, 1, 1, "", "onkey"], [0, 2, 1, "", "selected_clusters"], [0, 2, 1, "", "selected_grain_indices"]], "segmenteverygrain.Grain": [[0, 1, 1, "", "convert_units"], [0, 1, 1, "", "draw_axes"], [0, 1, 1, "", "draw_patch"], [0, 1, 1, "", "erase"], [0, 1, 1, "", "measure"], [0, 3, 1, "", "polygon"], [0, 1, 1, "", "select"]], "segmenteverygrain.GrainPlot": [[0, 1, 1, "", "activate"], [0, 1, 1, "", "clear_all"], [0, 1, 1, "", "clear_box"], [0, 1, 1, "", "clear_grains"], [0, 1, 1, "", "clear_info"], [0, 1, 1, "", "clear_points"], [0, 1, 1, "", "create_grain"], [0, 1, 1, "", "deactivate"], [0, 1, 1, "", "delete_grains"], [0, 1, 1, "", "draw_axes"], [0, 1, 1, "", "draw_scale_line"], [0, 1, 1, "", "get_grains"], [0, 1, 1, "", "hide_grains"], [0, 1, 1, "", "merge_grains"], [0, 1, 1, "", "onclick"], [0, 1, 1, "", "onclickup"], [0, 1, 1, "", "ondraw"], [0, 1, 1, "", "onkey"], [0, 1, 1, "", "onkeyup"], [0, 1, 1, "", "onmotion"], [0, 1, 1, "", "onpick"], [0, 1, 1, "", "savefig"], [0, 1, 1, "", "set_point"], [0, 1, 1, "", "toggle_box"], [0, 1, 1, "", "undo_grain"], [0, 1, 1, "", "update"], [0, 1, 1, "", "update_info"]]}, "objnames": {"0": ["py", "class", "Python class"], "1": ["py", "method", "Python method"], "2": ["py", "attribute", "Python attribute"], "3": ["py", "property", "Python property"], "4": ["py", "function", "Python function"]}, "objtypes": {"0": "py:class", "1": "py:method", "2": "py:attribute", "3": "py:property", "4": "py:function"}, "terms": {"": 0, "0": [0, 1], "092424": 1, "1": [0, 1, 2], "10": [0, 1], "100": [0, 1], "1000": [0, 1], "12": 1, "128": 0, "15": [0, 1], "150": 0, "15786086": 1, "16": 1, "1_hiera_l": 1, "1_hiera_larg": 1, "1d": 0, "1e": 1, "2": [0, 1, 2], "20": [0, 1], "200": 1, "2000": [0, 1], "2000x3000": 1, "21": 0, "2160": 0, "224": [0, 1], "224x224": [0, 1], "25": [0, 1], "255": [0, 1], "256": 1, "256x256": [0, 1], "25th": 0, "2d": 0, "3": [0, 1], "300": 0, "32": [0, 1], "336": 0, "3d": 0, "4": 0, "400": 1, "4096": [0, 1], "42": 0, "44": 1, "48": 1, "5": 0, "500": 1, "533": 1, "6": 1, "63": 0, "66": 1, "7": 0, "75th": 0, "8": 1, "9": 0, "922": 1, "937": 1, "A": [0, 1], "For": [1, 2], "If": [0, 1], "In": 1, "It": 0, "OR": 0, "One": 0, "Or": [1, 2], "That": 1, "The": [0, 1, 2], "Then": 1, "These": [0, 1, 2], "To": [1, 2], "With": 0, "_": 0, "_grain": 1, "_imag": 1, "_mask": 1, "_mask2": 1, "_subplot": 0, "_summari": 1, "about": 0, "abov": 1, "access": 1, "accord": 0, "accordingli": 0, "accuraci": [0, 1], "across": 0, "activ": [0, 1], "ad": [0, 1, 2], "adam": 1, "add": 0, "addit": 0, "adjust": 0, "after": [0, 1], "aim": 2, "algorithm": 0, "alia": 0, "align": 0, "all": [0, 1], "all_coord": [0, 1], "all_featur": 0, "all_grain": [0, 1], "all_imag": 0, "allow": 0, "alpha": 0, "alreadi": 0, "also": [0, 1, 2], "alt": [0, 1], "altern": [0, 1], "an": [0, 1, 2], "analysi": [0, 2], "ani": 0, "anim": 0, "anyth": [0, 2], "anywher": 0, "api": 2, "append": 0, "appl": [1, 2], "appli": 0, "approach": [0, 2], "ar": [0, 1, 2], "area": [0, 1], "argument": 0, "around": 0, "arrai": [0, 1], "arrang": 0, "artist": 0, "assign": 0, "assum": [0, 1], "astyp": 0, "attempt": 0, "augment": [0, 1], "auto": [0, 1], "automat": [0, 1, 2], "avail": 1, "averag": 0, "avoid": 1, "ax": [0, 1], "axessubplot": 0, "axi": [0, 1], "backend": 1, "backend_bas": 0, "background": [0, 1, 2], "background_threshold": 0, "bad": 1, "bar": [0, 2], "base": [0, 1, 2], "batch": [0, 1], "batch_siz": 0, "befor": [0, 1], "being": 0, "below": [0, 1], "best": 1, "better": 0, "between": 0, "bin": 0, "binari": [0, 1], "binsiz": [0, 1], "bit": 1, "black": [0, 1], "blit": [0, 1], "blue": [0, 1], "bool": 0, "boolean": 0, "border": 0, "both": 0, "bottom": 0, "bound": 0, "boundari": [0, 1], "boundary_thick": 0, "box": 0, "box_selector": 0, "build_sam": 1, "build_sam2": 1, "button": 0, "c": [0, 1], "calcul": 0, "calculate_i": 0, "call": 0, "can": [0, 1, 2], "categori": 1, "cd": 2, "center": 0, "centroid": 0, "channel": [0, 1], "check": 0, "circl": 0, "cl_panel": 0, "class": [1, 2], "class_color": [0, 1], "classif": [0, 1, 2], "classifi": [0, 2], "classify_point": 0, "clean": [1, 2], "clear": 0, "clear_al": 0, "clear_box": 0, "clear_grain": 0, "clear_info": 0, "clear_point": 0, "clf": 0, "click": [0, 1, 2], "click_for_scal": 0, "clone": 2, "cluster": 2, "cluster_grain": [0, 1], "cluster_id": 0, "cluster_info": [0, 1], "cluster_label": 0, "cluster_numb": 0, "clustermontagelabel": [0, 1], "clustermontageselector": [0, 1], "cmap": 0, "cnn": [0, 1, 2], "code": [1, 2], "col": 0, "colab": [0, 1], "collect": 0, "collect_polygon_from_mask": 0, "color": [0, 1], "color_bi": 0, "color_featur": [0, 1], "color_palett": [0, 1], "color_spac": [0, 1], "colormap": [0, 1], "column": 0, "com": [1, 2], "combin": 0, "come": 0, "common": 2, "comp": 0, "compact": 0, "compil": 1, "complet": [0, 1], "compon": 0, "comprehens": 0, "comput": [0, 1], "compute_curvatur": 0, "concaten": 0, "conda": 2, "config": 1, "connect": 0, "consid": 0, "consist": 1, "construct": 0, "contain": [0, 1], "continu": 0, "contour": 0, "control": [0, 2], "conveni": 1, "convers": [0, 2], "convert": [0, 1], "convert_to_large_image_coord": 0, "convert_unit": 0, "convolut": [0, 2], "coord": [0, 1], "coordin": 0, "core": 2, "corner": 0, "correspond": [0, 1], "cpu": 1, "creat": [0, 1, 2], "create_and_train_model": [0, 1], "create_clustered_grain_montag": [0, 1], "create_grain": 0, "create_grain_panel": 0, "create_grain_panel_clust": 0, "create_labeled_imag": 0, "create_train_val_test_data": [0, 1], "creation": [0, 1], "crop": 0, "cross": [0, 1], "csv": [0, 1], "ctrl": [0, 1], "cuda": 1, "current": 0, "curv": 0, "curvatur": 0, "custom": [0, 1], "custom_object": 1, "cv2": 1, "d": [0, 1, 2], "dark": 0, "data": [0, 1], "datafram": [0, 1], "dataset": [0, 1, 2], "dbs_max_dist": [0, 1], "dbscan": 0, "deactiv": [0, 1], "deal": 2, "decomposit": 0, "decreas": 0, "deep": [0, 1], "default": 0, "defin": [0, 1], "delet": [0, 1, 2], "delete_grain": 0, "deriv": 0, "desc": 1, "descend": 0, "describ": 1, "deselect": 0, "design": 0, "detail": 0, "detect": [0, 1, 2], "determin": [0, 2], "develop": 2, "deviat": 0, "devic": 1, "df": 0, "dict": 0, "dictionari": 0, "dimension": [0, 1], "directli": [0, 1], "directori": [0, 1], "disabl": 0, "discrimin": 0, "disk": 0, "displai": 0, "display_montag": 0, "distanc": 0, "distribut": 0, "dl": 1, "do": [0, 1], "doe": [0, 2], "don": 0, "done": 0, "dot": 1, "download": 1, "downscal": 0, "drag": [0, 1], "draw": [0, 1], "draw_ax": [0, 1], "draw_boundari": [0, 1], "draw_patch": 0, "draw_scale_lin": 0, "drawev": 0, "drawn": 1, "e": [0, 1], "each": [0, 1], "easiest": [1, 2], "edg": [0, 1], "edge_color": 0, "edge_width": 0, "edit": 2, "either": [0, 1], "els": 1, "enabl": 0, "end": [0, 1], "enough": 1, "ensur": 0, "entir": 0, "entropi": [0, 1], "env": 0, "environ": [0, 2], "environment_maco": 2, "epoch": [0, 1], "equal": 0, "eras": 0, "esc": [0, 1], "escap": 0, "etc": 0, "evenli": 0, "event": 0, "everi": 2, "everyth": 2, "exampl": [0, 1], "exclud": 0, "exist": [0, 1], "expect": 0, "export": [0, 1], "export_label": [0, 1], "extens": [0, 1], "extract": 2, "extract_all_grain": [0, 1], "extract_color_featur": [0, 1], "extract_grain_imag": [0, 1], "extract_patch": 0, "extract_vgg16_featur": [0, 1], "f": 0, "factor": 0, "fallback": 1, "fals": [0, 1], "fast": 0, "faster": 1, "fbaipublicfil": 1, "fc1": 0, "fc2": 0, "featur": [0, 2], "feature1": 0, "feature2": 0, "features_640": 0, "feldspar": [0, 1], "few": 1, "fig": [0, 1], "figsiz": [0, 1], "figur": [0, 1], "file": [0, 1, 2], "filenam": [0, 1], "filepath": 0, "fill": 0, "fill_alpha": 0, "filter": [0, 1], "filtered_all_grain": 0, "filtered_grain": [0, 1], "filtered_idx": 0, "filtered_imag": 0, "filtered_indic": 0, "filtered_label": 0, "find": 0, "find_connected_compon": 0, "find_grain_size_class": 0, "find_overlapping_polygon": 0, "fine": 1, "finetun": 2, "first": [0, 1, 2], "fit": 0, "flatten": 0, "float": 0, "flow": 0, "fn": 0, "fname": [0, 1], "folder": 1, "follow": 0, "foreground": [0, 1], "format": [0, 1], "found": [0, 1], "fraction": 0, "free": [0, 1], "from": [0, 2], "full": [0, 1], "fulli": 0, "function": [1, 2], "g": [0, 1], "gb": 1, "gener": [0, 1, 2], "geojson": [0, 1], "geologi": 2, "geomorphologi": 2, "get": [0, 2], "get_area_weighted_distribut": 0, "get_filtered_grain": [0, 1], "get_filtered_imag": 0, "get_filtered_indic": 0, "get_filtered_label": 0, "get_grain": [0, 1], "get_grains_from_patch": 0, "get_labeled_data": 0, "get_summari": [0, 1], "get_unlabeled_indic": 0, "git": 2, "github": [1, 2], "given": 0, "goal": 2, "goe": 1, "good": [0, 1, 2], "googl": 1, "gpu": [1, 2], "grain": 2, "grain_": 0, "grain_0": 0, "grain_1": 0, "grain_5": 0, "grain_data": [0, 1], "grain_imag": [0, 1], "grain_images_640x640": 0, "grain_img": [0, 1], "grain_ind": 0, "grain_index": 0, "grain_indic": 0, "grain_label": 1, "grain_mask": [0, 1], "grain_polygon": 0, "grain_pr": [0, 1], "grain_siz": 0, "grain_size_class": 0, "grain_util": [1, 2], "grainplot": [0, 1, 2], "graph": 0, "greater": 0, "green": [0, 1], "grian": 0, "grid": 0, "grid_col": [0, 1], "h": 0, "ha": 0, "handl": 0, "handler": 0, "happi": 1, "hardwar": 2, "have": [0, 1], "height": 0, "here": 1, "hidden": 0, "hide": [0, 1], "hide_grain": 0, "hierarch": 0, "high": 2, "highlight": [0, 1], "hist": 1, "histogram": [0, 1], "hold": [0, 1], "how": 1, "howev": 2, "hsv": [0, 1], "hsv_featur": 0, "http": [1, 2], "human": [0, 1], "i": [0, 1, 2], "id": 0, "idea": 1, "ignor": 0, "im": 0, "im_alpha": 0, "im_squar": 0, "im_til": 0, "im_tile_pr": 0, "imag": [0, 2], "image_alpha": 0, "image_dir": [0, 1], "image_max_s": 0, "image_path": 0, "image_pr": [0, 1], "img": 0, "immedi": 0, "import": 1, "improv": 2, "imshow": [0, 1], "imwrit": 1, "inch": 1, "includ": [0, 2], "include_preprocess": 0, "ind": 0, "index": 0, "indic": 0, "individu": [0, 2], "infer": 1, "info": [0, 1], "inform": 0, "ing": 1, "initi": 1, "input": [0, 1], "input_dir": [0, 1], "instanc": 0, "instant": 1, "int": 0, "interact": 2, "interest": 0, "interfac": [0, 1], "intern": 0, "interpret": 0, "intersect": 0, "iou": 0, "ipynb": 1, "is_avail": 1, "issu": 2, "item": 0, "iter": 0, "its": 0, "job": 2, "jpg": 1, "just": 1, "k": 1, "keep": [0, 1], "keep_edg": 0, "kei": 0, "kept": 0, "kera": [0, 1], "keyboard": [0, 1], "keyev": 0, "kmean": 0, "known": 1, "kwarg": 0, "lab": 0, "label": [0, 2], "label_color": 0, "label_grain": [0, 1], "label_nam": [0, 1], "labeled_grain": [0, 1], "labels_simpl": 0, "larg": [0, 2], "larger": 1, "last": [0, 1], "later": 0, "latest": [0, 1], "layer": 0, "layer_nam": 0, "learn": [0, 1, 2], "least": 1, "left": [0, 1], "legend": 0, "len": 0, "length": [0, 1], "level": 0, "lib": 0, "like": [0, 1, 2], "limit": 0, "line": [0, 1], "linewidth": 0, "link": 1, "list": [0, 1], "lithic": 1, "live": 0, "load": [0, 2], "load_and_preprocess": 0, "load_imag": [0, 1], "load_img": 1, "load_model": 1, "locat": 0, "long": 1, "longer": 0, "loss": [0, 1], "low": 1, "lower": 0, "lower_bound": 0, "m": [0, 1], "machin": [1, 2], "major": [0, 1], "major_axis_length": [0, 1], "make": [0, 1, 2], "make_squar": 0, "mamba": 2, "mani": 2, "map": 0, "mark": 0, "marker": 0, "markers": 0, "mask": [0, 1, 2], "mask_al": [0, 1], "mask_background": 0, "mask_dir": [0, 1], "mask_path": 0, "match": 0, "matching_class": 0, "matplotlib": [0, 1], "matrix": 0, "max": 0, "max_bg_fract": 0, "max_image_pixel": 1, "max_n_large_grain": 0, "maximum": 0, "mean": [0, 1], "measur": [0, 1], "median": 0, "memori": [0, 1], "merg": [0, 1, 2], "merge_grain": 0, "merge_overlapping_polygon": 0, "meta": 2, "meter": [0, 1], "method": [0, 1], "metric": 1, "middl": [0, 1], "might": 1, "millimet": 0, "min": 0, "min_area": [0, 1], "min_overlap": 0, "miniforge3": 0, "minim": 0, "minimum": 0, "minor": [0, 1], "minor_axis_length": [0, 1], "minspan": 0, "miss": 2, "mm": 1, "mode": [0, 1, 2], "model": 2, "model_fil": [0, 1], "model_nam": [0, 1], "moder": 1, "modern": 1, "modul": [1, 2], "montag": [0, 1], "more": [0, 1], "most": [0, 1, 2], "most_similar_polygon": 0, "mostli": 1, "motion": 0, "mous": [0, 1], "mouseev": 0, "mp": 1, "mpatch": 0, "much": 1, "multi": 1, "multipl": [0, 1], "must": [0, 1], "my_imag": 1, "my_large_imag": 1, "n_cluster": [0, 1], "n_col": 0, "n_compon": [0, 1], "n_featur": 0, "n_grain": 0, "n_row": 0, "name": [0, 1], "ndarrai": 0, "necessari": [0, 1], "need": [0, 1], "net": [0, 2], "network": 2, "networkx": 0, "neural": 2, "new": [0, 1], "new_grain": 0, "new_point": 0, "newli": 0, "next": 1, "non": 2, "none": [0, 1], "note": 0, "notebook": 1, "now": [0, 1], "np": [0, 1], "number": [0, 1], "numpi": [0, 1], "nvidia": 1, "o": 1, "object": [0, 1, 2], "off": [0, 1], "old": 0, "older": 1, "onc": [0, 1], "onclick": 0, "onclick2": 0, "onclick_large_imag": 0, "onclickup": 0, "ondraw": 0, "one": [0, 1], "one_point_prompt": 0, "ones": 0, "onkei": 0, "onkeyup": 0, "onli": [0, 1], "onmot": 0, "onpick": 0, "onpress": 0, "onpress2": 0, "optim": 1, "option": [0, 1], "order": 0, "org": 1, "organ": 0, "orig_s": [0, 1], "origin": 0, "original_s": 0, "other": [0, 1], "otherwis": 0, "ouput": 1, "out": 0, "out_fn": 1, "outer": [0, 1], "outlin": [1, 2], "output": [0, 1], "output_dir": 0, "over": 0, "overlai": [0, 1], "overlap": [0, 1, 2], "overlapping_polygon": 0, "overwrit": 0, "packag": [0, 1, 2], "pad": [0, 1], "pair": 1, "pan": 0, "panda": [0, 1], "panel": 0, "paramet": [0, 1], "part": 1, "pass": [0, 2], "patch": [0, 1, 2], "patch_dir": [0, 1], "patch_origin": 0, "patch_siz": [0, 1], "patchify_training_data": [0, 1], "path": [0, 1], "pca": [0, 1], "pd": 0, "per": [0, 1], "percentil": 0, "perceptu": 0, "perform": 0, "phi": 0, "photo": 2, "pick": 0, "pick_most_similar_polygon": 0, "pickev": 0, "pil": 1, "pip": 2, "pixel": [0, 1], "place": [0, 1], "plot": [0, 1], "plot_classified_grain": [0, 1], "plot_grain_axes_and_centroid": 0, "plot_histogram_of_axis_length": [0, 1], "plot_imag": [0, 1], "plot_image_w_colorful_grain": 0, "plot_images_and_label": 0, "plt": [0, 1], "png": [0, 1], "point": 0, "poly1": 0, "poly2": 0, "polygon": 1, "polygons_to_grain": [0, 1], "posit": 0, "possibl": [0, 2], "power": 1, "pre": [0, 1, 2], "predict": 2, "predict_imag": [0, 1], "predict_image_til": 0, "predict_large_imag": [0, 1], "predictor": [0, 1], "prefer": 0, "preliminari": 0, "preprocess": 0, "presenc": 0, "press": 0, "preview": 0, "previous": 0, "print": 0, "process": [0, 2], "programmat": 1, "progress": 0, "prompt": [0, 1, 2], "proper": 0, "properti": 0, "provid": [0, 1], "pt": 1, "pure": 0, "purpos": 0, "px_per_m": [0, 1], "py": 0, "pyplot": 1, "python": 2, "python3": 0, "qc": [1, 2], "qualiti": [0, 2], "quartz": [0, 1], "r": 0, "rand": 0, "random": 0, "random_st": 0, "randomli": 0, "rang": 0, "raster": 0, "rasterize_grain": [0, 1], "read": 0, "read_polygon": 0, "readabl": [0, 1], "readi": 1, "real": 1, "reason": 2, "recaptur": 0, "recent": [0, 1], "recommend": [0, 2], "record": 1, "rectangular": 0, "red": [0, 1], "redraw": 0, "reduc": [0, 1], "reduced_feat": 0, "reduced_featur": [0, 1], "reduct": [0, 1], "refer": [1, 2], "reference_mask": 0, "reflect": 0, "region": 0, "rel": 0, "releas": [0, 1], "reli": 2, "remain": 0, "remov": [0, 1], "remove_edge_grain": [0, 1], "remove_large_object": [0, 1], "render": 1, "repositori": [1, 2], "repres": [0, 1], "represent": 0, "reproduc": 0, "request": [0, 1], "requir": [0, 2], "rescal": 0, "reset": 0, "resiz": 0, "resnet50": 0, "result": [0, 2], "retriev": 1, "return": 0, "rgb": [0, 1], "right": [0, 1], "rotat": 0, "row": 0, "run": [0, 2], "said": 1, "sam": [0, 2], "sam2": 1, "sam2_image_predictor": 1, "sam2imagepredictor": [0, 1], "sam_segment": [0, 1], "same": 0, "sample1_imag": 1, "sample1_mask": 1, "save": [0, 2], "save_grain": [0, 1], "save_histogram": [0, 1], "save_labeled_imag": [0, 1], "save_mask": [0, 1], "save_polygon": 0, "save_summari": [0, 1], "savefig": [0, 1], "scale": [0, 2], "scale_m": [0, 1], "scatter": 1, "score": 0, "scratch": 2, "second": [0, 1], "section": 1, "sedimentari": 2, "see": 1, "seed": 0, "seg": 1, "seg_model": 1, "seg_model_finetun": 1, "segmant": 0, "segment": 2, "segment_anything_2": 1, "segment_every_grain": 1, "segmenteverygrain": [0, 1], "select": [0, 2], "select_onli": 0, "selected_clust": 0, "selected_grain_indic": 0, "selected_indic": 0, "selector": [0, 1], "self": 0, "semant": 0, "seri": 0, "set": [0, 1, 2], "set_imag": 1, "set_point": 0, "shape": [0, 1, 2], "shift": [0, 1], "should": [0, 1], "show": [0, 1], "shown": 1, "si": 1, "side": 0, "signific": 0, "significantli": 1, "silicon": [1, 2], "similar": 0, "singl": [0, 1], "site": 0, "size": [0, 2], "sklearn": 0, "slow": 2, "small": 1, "snippet": 1, "so": 2, "some": [0, 2], "sort": 0, "sort_by_s": 0, "sourc": 2, "space": 0, "spatial": 0, "specif": 0, "specifi": [0, 1], "speed": 1, "split": [0, 1], "squar": [0, 1], "square_imag": 0, "standard": [0, 1], "start": [0, 2], "state": 0, "statist": 0, "statu": 0, "std": 0, "step": 1, "store": 0, "str": 0, "stride": 0, "style": 2, "subdirectori": 0, "subfold": 1, "subplot": 0, "success": 0, "suitabl": [0, 1], "summar": [0, 1], "summari": [0, 1], "support": 0, "suppos": 1, "sx": 0, "sy": 0, "t": 0, "tab20": 0, "tab20b": 1, "take": [0, 1], "target": 0, "target_s": [0, 1], "task": [0, 1, 2], "temporarili": [0, 1], "tend": 2, "tensor": 0, "tensorflow": 0, "termin": 1, "test": [0, 1], "test_dataset": [0, 1], "text": 1, "tf": 0, "than": [0, 1], "thei": 0, "them": [0, 1, 2], "thi": [0, 1, 2], "thick": 0, "third": 0, "three": 1, "threshold": 0, "through": [0, 1], "tile": 0, "time": [0, 1], "titl": 1, "toggl": 0, "toggle_box": 0, "too": 1, "top": 0, "torch": 1, "touch": [0, 1], "tqdm": 1, "train": 2, "train_dataset": [0, 1], "train_unet_model": 1, "treat": 0, "trigger": 0, "true": [0, 1], "tune": 1, "tupl": 0, "turn": 1, "two": 0, "two_point_prompt": 0, "type": 0, "u": [0, 2], "uint8": 0, "undo": [0, 1], "undo_grain": 0, "unet": [0, 1, 2], "unhid": 0, "uniform": 0, "union": 0, "uniqu": 0, "unit": [0, 2], "unlabel": 0, "unrot": 0, "unselect": [0, 1], "up": [1, 2], "updat": [0, 1], "update_info": 0, "upper": 0, "upper_bound": 0, "url": 1, "urllib": 1, "urlretriev": 1, "us": [0, 1, 2], "user": [0, 2], "usual": 1, "util": 1, "val_dataset": [0, 1], "valid": [0, 1], "valu": [0, 1], "value1": 0, "value2": 0, "varieti": 1, "verbos": 0, "veri": [0, 1], "version": 1, "vertic": 0, "vgg16": [0, 1], "viridi": 0, "visual": 2, "w": 0, "wa": [0, 1], "wai": [0, 1, 2], "want": 1, "warn": 0, "we": 1, "weight": [0, 1], "weighted_crossentropi": [0, 1], "well": [1, 2], "were": [0, 2], "when": [0, 1, 2], "whenev": 0, "where": [0, 1], "whether": 0, "which": [0, 1, 2], "while": 0, "white": 0, "width": 0, "within": 0, "without": [0, 1], "work": [0, 1, 2], "workflow": 1, "world": 1, "write": 0, "x": 0, "x1": 0, "x2": 0, "xlimit": 0, "xtick": 1, "xy": 0, "y": 0, "y1": 0, "y2": 0, "y_pred": 0, "y_true": 0, "yaml": 1, "yml": 2, "you": [0, 1, 2], "your": 1, "ytick": 1, "z": [0, 1], "zenodo": 1, "zero": 0, "zoltan": 0, "zoom": 0, "zsylvest": 2}, "titles": ["API Reference", "Getting started", "segmenteverygrain"], "titleterms": {"analysi": 1, "api": 0, "bar": 1, "class": 0, "classifi": 1, "cluster": [0, 1], "content": 2, "control": 1, "convers": 1, "core": 0, "edit": [0, 1], "extract": [0, 1], "featur": 1, "finetun": 1, "from": 1, "function": 0, "get": 1, "grain": [0, 1], "grain_util": 0, "hardwar": 1, "imag": 1, "individu": 1, "instal": 2, "interact": [0, 1], "label": 1, "larg": 1, "legaci": 0, "load": 1, "model": [0, 1], "modul": 0, "net": 1, "oper": 0, "polygon": 0, "predict": [0, 1], "process": 1, "qualiti": 1, "refer": 0, "requir": 1, "result": 1, "run": 1, "sam": 1, "save": 1, "scale": 1, "scratch": 1, "segment": [0, 1], "segmenteverygrain": 2, "select": 1, "size": 1, "start": 1, "train": [0, 1], "u": 1, "unit": 1, "util": 0, "visual": [0, 1]}})